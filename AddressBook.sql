--UC-1
CREATE DATABASE Address_Book	
SELECT * FROM SYS.databases
USE Address_Book

--UC-2
CREATE TABLE AddressBook(
S_NO INT IDENTITY(1,1) NOT NULL PRIMARY KEY,
FIRST_NAME VARCHAR(20) NOT NULL,
LAST_NAME VARCHAR(20) NOT NULL,
ADDRESS VARCHAR(50) NOT NULL,
CITY VARCHAR(20) NOT NULL,
STATE VARCHAR(20) NOT NULL,
PIN INT NOT NULL,
PHONE INT NOT NULL,
EMAIL VARCHAR(40) NOT NULL
)
SELECT * FROM AddressBook

--UC-3
ALTER TABLE AddressBook ALTER COLUMN PHONE FLOAT
INSERT INTO AddressBook VALUES('NANTHAGOPAL','SHANMUGAM','NO 1 - COIMBATORE','COIMBATORE','TAMILNADU',656598,7894561230,'nantha@gmail.com') 
INSERT INTO AddressBook VALUES ('Ela','Appu','NO 2, Ela Address','Salem','Tamilnadu',654512,9856231478,'ela@gmail.com')
INSERT INTO AddressBook VALUES ('Priya','Reddy','NO 3, Priya Address','Palakkad','Kerala',565626,9523648952,'priya@gmail.com')
INSERT INTO AddressBook VALUES ('Ramya','Dhurai','NO 4, Pamya Address','Bangalore','Karnataka',564423,7842338370,'ramya@gmail.com')
INSERT INTO AddressBook VALUES ('Ravi','SHAN','NO 5, Ravi Address','COIMBATORE','TAMILNADU',658696,8855226699,'ravi@gmail.com')
INSERT INTO AddressBook VALUES ('Senthil','Dhurai','NO 4, Pamya Address','COIMBATORE','TAMILNADU',632145,9988332259,'senthil@gmail.com')

--UC-4
UPDATE AddressBook SET ADDRESS = 'UPDATED ADDRESS' WHERE FIRST_NAME = 'NANTHAGOPAL'

--UC-5
DELETE FROM AddressBook WHERE FIRST_NAME = 'Priya'

--UC-6
SELECT * FROM AddressBook WHERE CITY ='COIMBATORE'
SELECT * FROM AddressBook WHERE STATE = 'Tamilnadu'

--UC-7
SELECT CITY, COUNT(CITY) AS TOTAL_COUNT FROM AddressBook GROUP BY CITY
SELECT STATE, COUNT(STATE) AS TOTAL_STATE_COUNT FROM AddressBook GROUP BY STATE


--UC-8
SELECT * FROM AddressBook WHERE CITY = 'COIMBATORE' ORDER BY FIRST_NAME ASC

SELECT * FROM AddressBook

--UC-9
ALTER TABLE AddressBook ADD CONTACT_TYPE VARCHAR(20) NOT NULL DEFAULT ('')
UPDATE AddressBook SET CONTACT_TYPE = 'FAMILY' WHERE FIRST_NAME = 'NANTHAGOPAL'
UPDATE AddressBook set contact_type = 'FRIEND' WHERE FIRST_NAME = 'Ela'
UPDATE AddressBook SET CONTACT_TYPE = 'FAMILY' WHERE FIRST_NAME = 'Ramya'
UPDATE AddressBook SET CONTACT_TYPE = 'FRIEND' WHERE FIRST_NAME = 'Ravi'
UPDATE AddressBook SET CONTACT_TYPE = 'FAMILY' WHERE FIRST_NAME = 'Senthil'
SELECT CONTACT_TYPE, COUNT(CONTACT_TYPE) AS TOTAL_COUNT FROM AddressBook GROUP BY CONTACT_TYPE
SELECT * FROM AddressBook WHERE CONTACT_TYPE = 'FRIEND' ORDER BY FIRST_NAME ASC 